# vim:fileencoding=utf-8
# License: BSD
# Copyright: 2015, Kovid Goyal <kovid at kovidgoyal.net>

# Test literals

assert.equal(r'\n', '\\n')
assert.equal('\n'.charCodeAt(0), 10)
assert.equal('\'', "'")
assert.equal('\76'.charCodeAt(0), 62)  # octal escapes
assert.equal('\x2a'.charCodeAt(0), 0x2a)  # hex escapes
assert.equal('\u2028'.charCodeAt(0), 0x2028)
assert.equal("\U0001F431", 'üê±')
assert.equal("\U0001F431", 'üê±')
assert.equal("\N{nbsp}", '\u00a0')
assert.equal("\N{NBSP}", '\u00a0')

# Test format()

def test():
    args = Array.prototype.slice.call(arguments, 1)
    assert.equal(arguments[0], str.format.apply(None, args))

def test_throws():
    args = Array.prototype.slice.call(arguments)
    def f():
        return str.format.apply(None, args[1:])
    assert.throws(f, args[0])

test(' 1 2', ' {} {}', 1, 2)
test('{ a ', '{{ {0} ', 'a')
test('11', '{0}{0}', 1)
test('12', '{a}{b}', a=1, b=2)
test('12', '{a}{0}', 2, a=1)
test('1', '{0[0]}', [1])
test('1', '{0.a.b}', {'a':{'b':1}})
test('1', '{0[a][b]}', {'a':{'b':1}})
test('x', '{}', def (): return 'x';)
test_throws(AttributeError, '{0.a}', {})
test_throws(KeyError, '{a}', b=1)
test_throws(IndexError, '{} {}', 1)
test_throws(IndexError, '{1} {2}', 1)
